<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <title>カード作成</title>
  <style>
    body {
      font-family: sans-serif;
      text-align: center;
      padding: 20px;
    }
    canvas {
      border: 1px solid #ccc;
      margin-top: 10px;
    }
  </style>
</head>
<body>
  <h2>カード作成</h2>

  <!-- 入力欄 -->
    <input type="text" maxlength="3" id="cost" placeholder="ここにコストを入力(99以下)">
  　　<input type="text" maxlength="10" id="card_name" placeholder="名前を入力（10文字以下）">
    <input type="text" maxlength="3" id="attack" placeholder="攻撃力を入力(99以下)">
    <input type="text" maxlength="3" id="health" placeholder="ここに体力を入力（99以下）">
  
  <button onclick="drawText()">カード作成</button>
<button onclick="addcard()">カード登録</button>
    

  
  <!-- キャンバス -->
  <br>
  <canvas id="canvas" width="300" height="512"></canvas>

    
    
  <script>
    
    const canvas = document.getElementById("canvas");
      //2d（ペンのようなもの）二次元の描画をする
    const ctx = canvas.getContext("2d");

    // テンプレート画像の読み込み
    const template = new Image();
    template.src = "src/assets/card_template.png"; 
      
      
      //onload読み込みが完了したら呼ばれるメソッド
    template.onload = () => {
      ctx.drawImage(template, 0, 0, canvas.width, canvas.height);
    };

      
      
    function drawText() {
      // まず背景を再描画
      ctx.drawImage(template, 0, 0, canvas.width, canvas.height);

      const cost = document.getElementById("cost").value;
    
      const card_name = document.getElementById("card_name").value;
     
      const attack = document.getElementById("attack").value;
    
      const health = document.getElementById("health").value;

      // テキストのスタイル
      ctx.font = "40px sans-serif";
      ctx.fillStyle = "white";
      ctx.textAlign = "center";

      // (x, y) = 位置に描画
      ctx.fillText(cost, 41, 48);
      ctx.fillText(attack, 48, 474);
      ctx.fillText(health, 267, 472);
        
        if(card_name.length>5){
           ctx.font = "20px sans-serif"
            ctx.fillText(card_name, 200, 50);
           }else{
               ctx.font = "40px sans-serif"
            ctx.fillText(card_name, 200, 50);
           }
    }
      
 
      async function addcard() {
      const card_name = document.getElementById("card_name").value;
      const card_cost = document.getElementById("cost").value;
      const card_attack = document.getElementById("attack").value;
      const card_health = document.getElementById("health").value;
          
      await fetch("http://localhost:3001/card", {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify({ card_name: card_name,card_cost:card_cost,card_attack:card_attack,card_health:card_health })
      });
      }
 
  
  </script>
</body>
</html>
